{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Microsoft\\\\Documents\\\\capstone3\\\\capstone3\\\\src\\\\components\\\\bookingComponents\\\\myBookings.jsx\";\n\n/* My bookings page */\nimport React, { Component } from 'react';\nimport { Alert, Button, Container, Table } from 'react-bootstrap';\nimport BookingServiceApi from '../../api/BookingServiceApi';\nimport LocationServiceApi from '../../api/LocationServiceApi';\nimport CarServiceApi from '../../api/CarServiceApi';\nimport UserServiceApi from '../../api/UserServiceApi';\n\nclass MyBookingPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      bookings: [],\n      locations: [],\n      cars: [],\n      errorMessage: ''\n    };\n    this.handleCancelButton = this.handleCancelButton.bind(this);\n    this.getUsersBookings = this.getUsersBookings.bind(this);\n    this.checkBookingPast = this.checkBookingPast.bind(this);\n  }\n\n  componentDidMount() {\n    this.getUsersBookings(); // obtain all locations\n\n    LocationServiceApi.getAllLocations().then(res => {\n      let locationArray = this.state.locations;\n      res.data.forEach(location => {\n        let locationObject = {\n          id: location._id,\n          address: location.address,\n          name: location.name\n        };\n        locationArray.push(locationObject);\n        this.setState({\n          locations: locationArray\n        });\n      });\n    }).catch(error => {\n      this.setState({\n        errorMessage: error.response.data.message\n      });\n    }); // obtain all cars\n\n    CarServiceApi.getAllCars().then(res => {\n      this.setState({\n        cars: res.data.cars\n      });\n    }).catch(error => {\n      this.setState({\n        errorMessage: error.response.data.message\n      });\n    });\n  }\n\n  getUsersBookings() {\n    const userDetails = UserServiceApi.getLoggedInUserDetails();\n    BookingServiceApi.getUserBookings(userDetails.id).then(res => {\n      this.setState({\n        // sort bookings by latest\n        bookings: res.data.bookings.reverse()\n      });\n    }).catch(error => {\n      this.setState({\n        errorMessage: error.response.data.message\n      });\n    });\n  }\n\n  checkBookingPast(pickupTime) {\n    // check if booking pickup time hjas passed current time\n    let currentTime = new Date();\n    currentTime.setMinutes(currentTime.getMinutes() - currentTime.getTimezoneOffset());\n    return new Date(pickupTime) > currentTime;\n  }\n\n  handleCancelButton(booking) {\n    booking.status = 'Cancelled';\n    BookingServiceApi.modifyBooking(booking).then(() => {\n      this.getUsersBookings();\n    }).catch(error => {\n      this.setState({\n        errorMessage: error.response.data.message\n      });\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Container, {\n      className: \"mx-0\",\n      id: \"mybooking-page\",\n      fluid: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 13\n      }\n    }, this.state.errorMessage && /*#__PURE__*/React.createElement(Alert, {\n      variant: \"danger\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 45\n      }\n    }, /*#__PURE__*/React.createElement(Alert.Heading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }\n    }, \"Error obtaining bookings!\"), /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 21\n      }\n    }, this.state.errorMessage)), /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }\n    }, \"My Bookings\"), /*#__PURE__*/React.createElement(Table, {\n      striped: true,\n      bordered: true,\n      hover: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 29\n      }\n    }, \"Booking ID\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 29\n      }\n    }, \"Booked Time\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 29\n      }\n    }, \"Pickup Time\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 29\n      }\n    }, \"Return Time\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 29\n      }\n    }, \"Car\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 29\n      }\n    }, \"Cost\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 29\n      }\n    }, \"Location\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 29\n      }\n    }, \"Address\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 29\n      }\n    }, \"Status\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 29\n      }\n    }))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 21\n      }\n    }, this.state.bookings.map(booking => /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 33\n      }\n    }, booking.id), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 33\n      }\n    }, booking.bookedtime), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 33\n      }\n    }, booking.pickuptime), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 33\n      }\n    }, booking.returntime), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 33\n      }\n    }, this.state.cars.map(car => /*#__PURE__*/React.createElement(React.Fragment, null, car.id === booking.car && /*#__PURE__*/React.createElement(React.Fragment, null, car.make)))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 33\n      }\n    }, \"Php\", booking.cost), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 33\n      }\n    }, this.state.locations.map(location => /*#__PURE__*/React.createElement(React.Fragment, null, location.id === booking.location && /*#__PURE__*/React.createElement(React.Fragment, null, location.name)))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 33\n      }\n    }, this.state.locations.map(location => /*#__PURE__*/React.createElement(React.Fragment, null, location.id === booking.location && /*#__PURE__*/React.createElement(React.Fragment, null, location.address)))), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 33\n      }\n    }, booking.status), /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 33\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      href: `/mybookings/${booking.id}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 37\n      }\n    }, \"View\")), booking.status === \"Confirmed\" && this.checkBookingPast(booking.pickuptime) && /*#__PURE__*/React.createElement(\"td\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      variant: \"danger\",\n      onClick: () => this.handleCancelButton(booking),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 41\n      }\n    }, \"Cancel\")))))));\n  }\n\n}\n\nexport default MyBookingPage;","map":{"version":3,"sources":["C:/Users/Microsoft/Documents/capstone3/capstone3/src/components/bookingComponents/myBookings.jsx"],"names":["React","Component","Alert","Button","Container","Table","BookingServiceApi","LocationServiceApi","CarServiceApi","UserServiceApi","MyBookingPage","constructor","props","state","bookings","locations","cars","errorMessage","handleCancelButton","bind","getUsersBookings","checkBookingPast","componentDidMount","getAllLocations","then","res","locationArray","data","forEach","location","locationObject","id","_id","address","name","push","setState","catch","error","response","message","getAllCars","userDetails","getLoggedInUserDetails","getUserBookings","reverse","pickupTime","currentTime","Date","setMinutes","getMinutes","getTimezoneOffset","booking","status","modifyBooking","render","map","bookedtime","pickuptime","returntime","car","make","cost"],"mappings":";;AAAA;AACA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAwBC,SAAxB,EAAmCC,KAAnC,QAAgD,iBAAhD;AACA,OAAOC,iBAAP,MAA8B,6BAA9B;AACA,OAAOC,kBAAP,MAA+B,8BAA/B;AACA,OAAOC,aAAP,MAA0B,yBAA1B;AACA,OAAOC,cAAP,MAA2B,0BAA3B;;AAEA,MAAMC,aAAN,SAA4BT,SAA5B,CAAsC;AAClCU,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACTC,MAAAA,QAAQ,EAAE,EADD;AAETC,MAAAA,SAAS,EAAE,EAFF;AAGTC,MAAAA,IAAI,EAAE,EAHG;AAITC,MAAAA,YAAY,EAAE;AAJL,KAAb;AAMA,SAAKC,kBAAL,GAA0B,KAAKA,kBAAL,CAAwBC,IAAxB,CAA6B,IAA7B,CAA1B;AACA,SAAKC,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBD,IAAtB,CAA2B,IAA3B,CAAxB;AACA,SAAKE,gBAAL,GAAwB,KAAKA,gBAAL,CAAsBF,IAAtB,CAA2B,IAA3B,CAAxB;AACH;;AAEDG,EAAAA,iBAAiB,GAAG;AAChB,SAAKF,gBAAL,GADgB,CAEhB;;AACAb,IAAAA,kBAAkB,CAACgB,eAAnB,GACKC,IADL,CACUC,GAAG,IAAI;AACT,UAAIC,aAAa,GAAG,KAAKb,KAAL,CAAWE,SAA/B;AACAU,MAAAA,GAAG,CAACE,IAAJ,CAASC,OAAT,CAAiBC,QAAQ,IAAI;AACzB,YAAIC,cAAc,GAAG;AACjBC,UAAAA,EAAE,EAAEF,QAAQ,CAACG,GADI;AAEjBC,UAAAA,OAAO,EAAEJ,QAAQ,CAACI,OAFD;AAGjBC,UAAAA,IAAI,EAAEL,QAAQ,CAACK;AAHE,SAArB;AAKAR,QAAAA,aAAa,CAACS,IAAd,CAAmBL,cAAnB;AACA,aAAKM,QAAL,CAAc;AAAErB,UAAAA,SAAS,EAAEW;AAAb,SAAd;AACH,OARD;AASH,KAZL,EAYOW,KAZP,CAYcC,KAAD,IAAW;AAChB,WAAKF,QAAL,CAAc;AAAEnB,QAAAA,YAAY,EAAEqB,KAAK,CAACC,QAAN,CAAeZ,IAAf,CAAoBa;AAApC,OAAd;AACH,KAdL,EAHgB,CAkBhB;;AACAhC,IAAAA,aAAa,CAACiC,UAAd,GACKjB,IADL,CACUC,GAAG,IAAI;AACT,WAAKW,QAAL,CAAc;AACVpB,QAAAA,IAAI,EAAES,GAAG,CAACE,IAAJ,CAASX;AADL,OAAd;AAGH,KALL,EAKOqB,KALP,CAKcC,KAAD,IAAW;AAChB,WAAKF,QAAL,CAAc;AAAEnB,QAAAA,YAAY,EAAEqB,KAAK,CAACC,QAAN,CAAeZ,IAAf,CAAoBa;AAApC,OAAd;AACH,KAPL;AAQH;;AAEDpB,EAAAA,gBAAgB,GAAG;AACf,UAAMsB,WAAW,GAAGjC,cAAc,CAACkC,sBAAf,EAApB;AACArC,IAAAA,iBAAiB,CAACsC,eAAlB,CAAkCF,WAAW,CAACX,EAA9C,EACKP,IADL,CACUC,GAAG,IAAI;AACT,WAAKW,QAAL,CAAc;AACV;AACAtB,QAAAA,QAAQ,EAAEW,GAAG,CAACE,IAAJ,CAASb,QAAT,CAAkB+B,OAAlB;AAFA,OAAd;AAIH,KANL,EAMOR,KANP,CAMcC,KAAD,IAAW;AAChB,WAAKF,QAAL,CAAc;AAAEnB,QAAAA,YAAY,EAAEqB,KAAK,CAACC,QAAN,CAAeZ,IAAf,CAAoBa;AAApC,OAAd;AACH,KARL;AASH;;AAEDnB,EAAAA,gBAAgB,CAACyB,UAAD,EAAa;AACzB;AACA,QAAIC,WAAW,GAAG,IAAIC,IAAJ,EAAlB;AACAD,IAAAA,WAAW,CAACE,UAAZ,CAAuBF,WAAW,CAACG,UAAZ,KAA2BH,WAAW,CAACI,iBAAZ,EAAlD;AACA,WAAO,IAAIH,IAAJ,CAASF,UAAT,IAAuBC,WAA9B;AACH;;AAED7B,EAAAA,kBAAkB,CAACkC,OAAD,EAAU;AACxBA,IAAAA,OAAO,CAACC,MAAR,GAAiB,WAAjB;AACA/C,IAAAA,iBAAiB,CAACgD,aAAlB,CAAgCF,OAAhC,EACK5B,IADL,CACU,MAAM;AACR,WAAKJ,gBAAL;AACH,KAHL,EAGOiB,KAHP,CAGcC,KAAD,IAAW;AAChB,WAAKF,QAAL,CAAc;AAAEnB,QAAAA,YAAY,EAAEqB,KAAK,CAACC,QAAN,CAAeZ,IAAf,CAAoBa;AAApC,OAAd;AACH,KALL;AAMH;;AAEDe,EAAAA,MAAM,GAAG;AACL,wBACI,oBAAC,SAAD;AAAW,MAAA,SAAS,EAAC,MAArB;AAA4B,MAAA,EAAE,EAAC,gBAA/B;AAAgD,MAAA,KAAK,MAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAK1C,KAAL,CAAWI,YAAX,iBAA2B,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACxB,oBAAC,KAAD,CAAO,OAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCADwB,eAExB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKJ,KAAL,CAAWI,YADhB,CAFwB,CADhC,eAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAPJ,eAQI,oBAAC,KAAD;AAAO,MAAA,OAAO,MAAd;AAAe,MAAA,QAAQ,MAAvB;AAAwB,MAAA,KAAK,MAA7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAHJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAJJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aALJ,eAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cANJ,eAOI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAPJ,eAQI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBARJ,eASI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBATJ,eAUI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAVJ,CADJ,CADJ,eAeI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKJ,KAAL,CAAWC,QAAX,CAAoB0C,GAApB,CAAwBJ,OAAO,iBAC5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKA,OAAO,CAACrB,EAAb,CADJ,eAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKqB,OAAO,CAACK,UAAb,CAFJ,eAGI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKL,OAAO,CAACM,UAAb,CAHJ,eAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKN,OAAO,CAACO,UAAb,CAJJ,eAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAK9C,KAAL,CAAWG,IAAX,CAAgBwC,GAAhB,CAAoBI,GAAG,iBACpB,0CACKA,GAAG,CAAC7B,EAAJ,KAAWqB,OAAO,CAACQ,GAAnB,iBACG,0CACKA,GAAG,CAACC,IADT,CAFR,CADH,CADL,CALJ,eAgBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAQT,OAAO,CAACU,IAAhB,CAhBJ,eAiBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKjD,KAAL,CAAWE,SAAX,CAAqByC,GAArB,CAAyB3B,QAAQ,iBAC9B,0CACKA,QAAQ,CAACE,EAAT,KAAgBqB,OAAO,CAACvB,QAAxB,iBACG,0CACKA,QAAQ,CAACK,IADd,CAFR,CADH,CADL,CAjBJ,eA4BI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKrB,KAAL,CAAWE,SAAX,CAAqByC,GAArB,CAAyB3B,QAAQ,iBAC9B,0CACKA,QAAQ,CAACE,EAAT,KAAgBqB,OAAO,CAACvB,QAAxB,iBACG,0CACKA,QAAQ,CAACI,OADd,CAFR,CADH,CADL,CA5BJ,eAuCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAKmB,OAAO,CAACC,MAAb,CAvCJ,eAwCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,MAAD;AAAQ,MAAA,IAAI,EAAG,eAAcD,OAAO,CAACrB,EAAG,EAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,CAxCJ,EA2CMqB,OAAO,CAACC,MAAR,KAAmB,WAAnB,IAAkC,KAAKhC,gBAAL,CAAsB+B,OAAO,CAACM,UAA9B,CAAnC,iBACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,MAAD;AAAQ,MAAA,OAAO,EAAC,QAAhB;AAAyB,MAAA,OAAO,EAAE,MAAM,KAAKxC,kBAAL,CAAwBkC,OAAxB,CAAxC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADJ,CA5CR,CADH,CADL,CAfJ,CARJ,CADJ;AAgFH;;AA1JiC;;AA6JtC,eAAe1C,aAAf","sourcesContent":["/* My bookings page */\r\nimport React, { Component } from 'react';\r\nimport { Alert, Button, Container, Table } from 'react-bootstrap';\r\nimport BookingServiceApi from '../../api/BookingServiceApi';\r\nimport LocationServiceApi from '../../api/LocationServiceApi';\r\nimport CarServiceApi from '../../api/CarServiceApi';\r\nimport UserServiceApi from '../../api/UserServiceApi';\r\n\r\nclass MyBookingPage extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = {\r\n            bookings: [],\r\n            locations: [],\r\n            cars: [],\r\n            errorMessage: ''\r\n        };\r\n        this.handleCancelButton = this.handleCancelButton.bind(this);\r\n        this.getUsersBookings = this.getUsersBookings.bind(this);\r\n        this.checkBookingPast = this.checkBookingPast.bind(this);\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.getUsersBookings();\r\n        // obtain all locations\r\n        LocationServiceApi.getAllLocations()\r\n            .then(res => {\r\n                let locationArray = this.state.locations;\r\n                res.data.forEach(location => {\r\n                    let locationObject = {\r\n                        id: location._id,\r\n                        address: location.address,\r\n                        name: location.name\r\n                    };\r\n                    locationArray.push(locationObject);\r\n                    this.setState({ locations: locationArray });\r\n                });\r\n            }).catch((error) => {\r\n                this.setState({ errorMessage: error.response.data.message });\r\n            })\r\n        // obtain all cars\r\n        CarServiceApi.getAllCars()\r\n            .then(res => {\r\n                this.setState({\r\n                    cars: res.data.cars\r\n                });\r\n            }).catch((error) => {\r\n                this.setState({ errorMessage: error.response.data.message });\r\n            });\r\n    }\r\n\r\n    getUsersBookings() {\r\n        const userDetails = UserServiceApi.getLoggedInUserDetails();\r\n        BookingServiceApi.getUserBookings(userDetails.id)\r\n            .then(res => {\r\n                this.setState({\r\n                    // sort bookings by latest\r\n                    bookings: res.data.bookings.reverse()\r\n                });\r\n            }).catch((error) => {\r\n                this.setState({ errorMessage: error.response.data.message });\r\n            });\r\n    }\r\n\r\n    checkBookingPast(pickupTime) {\r\n        // check if booking pickup time hjas passed current time\r\n        let currentTime = new Date();\r\n        currentTime.setMinutes(currentTime.getMinutes() - currentTime.getTimezoneOffset());\r\n        return new Date(pickupTime) > currentTime;\r\n    }\r\n\r\n    handleCancelButton(booking) {\r\n        booking.status = 'Cancelled';\r\n        BookingServiceApi.modifyBooking(booking)\r\n            .then(() => {\r\n                this.getUsersBookings();\r\n            }).catch((error) => {\r\n                this.setState({ errorMessage: error.response.data.message });\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Container className=\"mx-0\" id=\"mybooking-page\" fluid>\r\n                {this.state.errorMessage && <Alert variant=\"danger\">\r\n                    <Alert.Heading>Error obtaining bookings!</Alert.Heading>\r\n                    <p>\r\n                        {this.state.errorMessage}\r\n                    </p>\r\n                </Alert>}\r\n                <h2>My Bookings</h2>\r\n                <Table striped bordered hover>\r\n                    <thead>\r\n                        <tr>\r\n                            <th>Booking ID</th>\r\n                            <th>Booked Time</th>\r\n                            <th>Pickup Time</th>\r\n                            <th>Return Time</th>\r\n                            <th>Car</th>\r\n                            <th>Cost</th>\r\n                            <th>Location</th>\r\n                            <th>Address</th>\r\n                            <th>Status</th>\r\n                            <th></th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {this.state.bookings.map(booking =>\r\n                            <tr>\r\n                                <td>{booking.id}</td>\r\n                                <td>{booking.bookedtime}</td>\r\n                                <td>{booking.pickuptime}</td>\r\n                                <td>{booking.returntime}</td>\r\n                                <td>\r\n                                    {this.state.cars.map(car =>\r\n                                        <>\r\n                                            {car.id === booking.car &&\r\n                                                <>\r\n                                                    {car.make}\r\n                                                </>\r\n                                            }\r\n                                        </>\r\n                                    )}\r\n                                </td>\r\n                                <td>Php{booking.cost}</td>\r\n                                <td>\r\n                                    {this.state.locations.map(location =>\r\n                                        <>\r\n                                            {location.id === booking.location &&\r\n                                                <>\r\n                                                    {location.name}\r\n                                                </>\r\n                                            }\r\n                                        </>\r\n                                    )}\r\n                                </td>\r\n                                <td>\r\n                                    {this.state.locations.map(location =>\r\n                                        <>\r\n                                            {location.id === booking.location &&\r\n                                                <>\r\n                                                    {location.address}\r\n                                                </>\r\n                                            }\r\n                                        </>\r\n                                    )}\r\n                                </td>\r\n                                <td>{booking.status}</td>\r\n                                <td>\r\n                                    <Button href={`/mybookings/${booking.id}`}>View</Button>\r\n                                </td>\r\n                                {(booking.status === \"Confirmed\" && this.checkBookingPast(booking.pickuptime)) &&\r\n                                    <td>\r\n                                        <Button variant=\"danger\" onClick={() => this.handleCancelButton(booking)}>Cancel</Button>\r\n                                    </td>\r\n                                }\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                </Table>\r\n            </Container>\r\n        )\r\n    }\r\n}\r\n\r\nexport default MyBookingPage;\r\n"]},"metadata":{},"sourceType":"module"}